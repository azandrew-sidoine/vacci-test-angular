<div class="dashboard-preview">
  <div class="app-page-header">
    <h2>Gestionnaire des utilisateurs du système</h2>
    <div class="app-intro">
      <span [translate]="'users.subText'"></span>
    </div>
  </div>
  <ng-container *ngIf="state$ | async as vm">
    <clr-datagrid #clrDataGrid (clrDgRefresh)="onDgRefresh($event)" [clrDgLoading]="vm?.performingAction"
      class="datagrid-compact">
      <clr-dg-action-bar>
        <drewlabs-datgrid-header (createEvent)="handleCreateEvent()" (refreshEvent)="onDgHeaderRefresh()"
          [showAssignmentButton]="false" [showExportDropdown]="false"></drewlabs-datgrid-header>
      </clr-dg-action-bar>
      <!-- <clr-dg-column [clrDgField]="'id'">ID</clr-dg-column> -->
      <clr-dg-column [clrDgField]="'user_info__firstname'">Nom</clr-dg-column>
      <clr-dg-column [clrDgField]="'user_info__lastname'">Prénoms</clr-dg-column>
      <clr-dg-column [clrDgField]="'user_info__phone_number'">Numéro Tel.</clr-dg-column>
      <clr-dg-column [clrDgField]="'user_info__email'">E-mail</clr-dg-column>
      <clr-dg-column>Départment</clr-dg-column>
      <clr-dg-column>Status</clr-dg-column>
      <clr-dg-row *ngFor="let item of vm?.dataSource?.data">
        <clr-dg-action-overflow>
          <button class="action-item" (click)="handleEditEvent(item.id)">{{'ÉDITER' | uppercase }}</button>
          <button class="action-item" (click)="handleDeleteEvent(item.id, vm?.translations)">{{'SUPPRIMER' | uppercase
            }}</button>
        </clr-dg-action-overflow>
        <clr-dg-cell>{{ item.userInfo?.lastname }}</clr-dg-cell>
        <clr-dg-cell>{{ item.userInfo?.firstname }}</clr-dg-cell>
        <clr-dg-cell>{{ item.userDetails?.phoneNumber }}</clr-dg-cell>
        <clr-dg-cell>{{ item.userDetails?.email }}</clr-dg-cell>
        <clr-dg-cell>
          <clr-icon *ngIf="item.userDetails?.isManager" shape="administrator"></clr-icon>
        </clr-dg-cell>
        <clr-dg-cell>{{ item.userDetails?.department }}</clr-dg-cell>
        <clr-dg-row-detail *clrIfExpanded>
          <span class="role-list">{{item?.rolesAsString}}</span>
        </clr-dg-row-detail>
      </clr-dg-row>
      <clr-dg-footer>
        <clr-dg-pagination #pagination [clrDgPageSize]="initialGridState?.per_page"
          [clrDgTotalItems]="vm?.dataSource?.total">
          <clr-dg-page-size [clrPageSizeOptions]="[10, 20, 30]"></clr-dg-page-size>
          {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}}
          {{ 'pagination.of' | translate}} {{pagination.totalItems}}
          Utilisateurs
        </clr-dg-pagination>
      </clr-dg-footer>
    </clr-datagrid>
  </ng-container>
</div>